{% extends "base.html" %}
{% block title %}Net Sessions{% endblock %}
{% block content %}
<h2>Organized Nets</h2>
<div class="chip-row">
    <input type="search" placeholder="Search nets, clubs, or times" data-search-target="#nets-table tbody tr" data-search-empty="#nets-empty" />
</div>
<table id="nets-table">
    <thead>
        <tr>
            <th>Name</th>
            <th>Club</th>
            <th>Start</th>
            <th>Duration (min)</th>
            <th>Structure</th>
            <th>Participants</th>
            <th>Formal Check-ins</th>
            <th>Confidence</th>
        </tr>
    </thead>
    <tbody>
        {% for net in nets %}
        <tr data-search-text="{{ net.name }} {{ net.club }} {{ net.start_time }}">
            <td><a href="/nets/{{ net.id }}">{{ net.name }}</a></td>
            <td>{{ net.club or '—' }}</td>
            <td>{{ net.start_time }}</td>
            <td>{{ net.duration_sec // 60 }}</td>
            <td>
                {% if net.formal_structure %}
                    {% set fs = net.formal_structure %}
                    <span title="Opening: {{ 'Yes' if fs.get('has_opening') else 'No' }}, Check-ins: {{ 'Yes' if fs.get('has_checkins') else 'No' }}, Closing: {{ 'Yes' if fs.get('has_closing') else 'No' }}">
                        {{ '✓' if fs.get('has_opening') else '✗' }}
                        {{ '✓' if fs.get('has_checkins') else '✗' }}
                        {{ '✓' if fs.get('has_closing') else '✗' }}
                    </span>
                {% else %}
                    —
                {% endif %}
            </td>
            <td>{{ net.participants }}</td>
            <td>
                {% if net.checkin_sequence %}
                    {{ net.checkin_sequence | length }}
                {% else %}
                    —
                {% endif %}
            </td>
            <td>{{ '{:.0%}'.format(net.confidence) if net.confidence else '—' }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
<p id="nets-empty" class="muted" hidden>No nets match your search.</p>
{% endblock %}
